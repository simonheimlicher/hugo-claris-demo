name: Deploy Hugo Site to Cloudflare Pages

on:
  push:
  pull_request:
  # Allows you to run this workflow manually from the Actions tab
  workflow_dispatch:

jobs:
  # Call the workflow to build with Hugo and deploy to Cloudflare Pages
  # Builds twice (prod + debug) and deploys to two CF Pages projects
  cloudflare-pages:
    uses: simonheimlicher/claris-gh-actions/.github/workflows/cloudflare-pages.yml@main
    with:
      HUGO_VERSION: ${{ vars.HUGO_VERSION || '0.153.5' }}
      DART_SASS_VERSION: ${{ vars.DART_SASS_VERSION || '1.97.2' }}
      BASE_URL: ${{ vars.BASE_URL }}
      BASE_URL_DEBUG: ${{ vars.BASE_URL_DEBUG }}
      CANONICAL_BASE_URL: ${{ vars.CANONICAL_BASE_URL || vars.BASE_URL }}
      CLOUDFLARE_PROJECT_NAME: ${{ vars.CLOUDFLARE_PROJECT_NAME }}
      CLOUDFLARE_PROJECT_NAME_DEBUG: ${{ vars.CLOUDFLARE_PROJECT_NAME_DEBUG }}
    secrets:
      HUGO_CLARIS_AUTHOR_EMAIL: ${{ secrets.HUGO_CLARIS_AUTHOR_EMAIL }}
      CLOUDFLARE_ZONE_ID: ${{ secrets.CLOUDFLARE_ZONE_ID }}
      CLOUDFLARE_API_TOKEN: ${{ secrets.CLOUDFLARE_API_TOKEN }}
      CLOUDFLARE_ACCOUNT_ID: ${{ secrets.CLOUDFLARE_ACCOUNT_ID }}
    permissions:
      contents: read
      deployments: write
